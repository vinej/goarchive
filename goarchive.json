{
"Connections" : [
    {   "Name" : "corpo",
        "Driver" : "sqlserver",
        "DataSourceName" : "saa:Hydne3/44@DESKTOP-L1MM0UJ?database=archive"
    },
    {   "Name" : "project",
        "Driver" : "sqlserver",
        "DataSourceName" : "saa:Hydne3/44@DESKTOP-L1MM0UJ?database=archive"
    }
],
"Tasks" : [
    {   "Id" : "2",
        "Kind" : "query",  
        "Name" : "projects",
        "Description" : "list of projects",
        "Connection" : "corpo",
        "Command":"select id, name, description from archive.dbo.projects",
        "OutputType" : "memory"
    },
    {   "Id" : "3",
        "Kind" : "query",  
        "Name" : "periodes",
        "Description" : "list of periodes",
        "Connection" : "project",
        "Command":"select id,code from archive.dbo.Periodes",
        "OutputType" : "memory"
    },
    {   "Id" : "4",
        "Kind" : "query",  
        "Name" : "names",
        "Description" : "list of names by project",
        "Connection" : "project",
        "Command":"select * from archive.dbo.names where project = {project} and (periode = {per_prec} or periode = {per_curr})",
        "Parameters" : [
            {
                "Name" : ["{project}"],
                "SourceName": "projects",
                "Field" : ["id"]
            },
            {
                "Name" : ["{per_prec}", "{per_curr}"],
                "SourceName": "periodes",
                "Field" : ["id", "id"]
            }
        ],
        "OutputType" : "excel",
        "OutputName" : "goarchive.xlsx"
    }
]
}