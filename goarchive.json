{
"Connections" : [
    { 
        "Name" : "corpo",
        "Driver" : "sqlserver",
        "ConnectionString" : "saa:Hydne3/44@DESKTOP-L1MM0UJ?database=archive"
    },
    {
        "Name" : "project",
        "Driver" : "sqlserver",
        "ConnectionString" : "saa:Hydne3/44@DESKTOP-L1MM0UJ?database=archive"
    }
],
"Tasks" : [
    { 
        "Name" : "tests",
        "Kind" : "array",  
        "Description" : "list of country",
        "Command":"Canada|France|Germany",
        "OutputType" : "memory"
    },
    { 
        "Name" : "projects",
        "Kind" : "query",  
        "Description" : "list of projects",
        "Connection" : "corpo",
        "Command":"select [id], [name], [description], [database] from archive.dbo.projects",
        "OutputType" : "memory"
    },
    { 
        "Name" : "periodes",
        "Kind" : "query",  
        "Description" : "list of periodes",
        "Connection" : "project",
        "Command":"select id,code from archive.dbo.Periodes where project = {project}",
        "OutputType" : "reference"
    },
    { 
        "Name" : "names",
        "Kind" : "query",  
        "Description" : "list of names by project",
        "Connection" : "project",
        "Command":"select * from archive.dbo.names where project = {project} and (periode = {per_prec} or periode = {per_curr})",
        "Parameters" : [
            {
                "Names" : ["{project}"],
                "Fields" : ["id"],
                "Source": "projects",
                "UseDatabase": "database",
                "Kind": "parent"
            },
            {
                "Names" : ["{per_prec}", "{per_curr}"],
                "Fields" : ["id", "id"],
                "Source": "periodes",
                "Kind" : "child"
            }
        ],
        "OutputType" : "excel",
        "OutputName" : "goarchive.xlsx"
    }
]
}